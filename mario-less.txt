For this one, I based my code off someone else's, freely available on git.
Here's the link: https://gist.github.com/deeunix/87d6e569b4760d0559465f985c7d3481